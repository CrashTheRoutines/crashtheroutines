<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Redirecting...</title>
    <script defer>
      (async function () {
        try {
          const res = await fetch("https://api.country.is/");
          const data = await res.json();
          const country = data.country.toLowerCase();

          let lang = "ru"; // язык по умолчанию

          const ruCountries = ["ru", "by", "kz", "kg", "ua", "uz", "tj"];
          const esCountries = ["es", "mx", "ar", "cl", "co", "pe", "ve"];

          if (ruCountries.includes(country)) {
            lang = "ru";
          } else if (esCountries.includes(country)) {
            lang = "es";
          }

          window.location.replace(`/${lang}/`);
        } catch (e) {
          // Если ошибка — перенаправим на английскую версию
          window.location.replace("/en/");
        }

        localStorage.setItem("lang", lang);

        const savedLang = localStorage.getItem("lang");
        if (savedLang) {
          window.location.replace(`/${savedLang}/`);
          return;
        }
      })();
    </script>
  </head>
  <body>
    <p>Redirecting based on your location...</p>
  </body>
</html>
